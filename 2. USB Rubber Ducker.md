# Bad USB: USB Rubber Ducky

The USB Rubber Ducky is a versatile penetration testing device designed to emulate a USB keyboard, allowing it to execute predefined keystroke sequences quickly and covertly on a target computer. Created by Hak5, this tool is popular among cybersecurity professionals, red teamers, and ethical hackers due to its efficiency in performing automated attacks, often through social engineering and USB HID (Human Interface Device) injection.

[USB Rubber Ducky](https://shop.hak5.org/products/usb-rubber-ducky)

### Key Features

1. **Keyboard Emulation**:
    - The Rubber Ducky appears as a standard HID keyboard to the target system, making it effective even against systems with USB device restrictions that still allow keyboard inputs.
    - When plugged into a computer, it can execute a payload of pre-programmed keystrokes at speeds far faster than a human could type, bypassing many security checks.
2. **Ducky Script**:
    - The USB Rubber Ducky is programmed using its custom scripting language, **Ducky Script**, which is simple and efficient for designing payloads.
    - Ducky Script consists of basic commands like `STRING`, `DELAY`, and `ENTER`, allowing users to control typing and timing.
    - Payloads can be tailored to specific operating systems, applications, or even custom sequences to avoid detection.
3. **Cross-Platform Compatibility**:
    - It works on major operating systems, including Windows, macOS, Linux, and Android, making it versatile for diverse environments.
    - Since it is recognized as a keyboard, it bypasses restrictions for specific devices, giving it a broader reach in various system environments.
4. **MicroSD Card for Payload Storage**:
    - The USB Rubber Ducky has a slot for a microSD card where payloads are stored. Users can quickly change payloads by swapping out the SD card.
    - This feature allows for rapid deployment and easy customization during penetration tests, enabling multiple attack scenarios in a short time frame.
5. **Plug-and-Play Operation**:
    - Once a payload is loaded, the Rubber Ducky can be used simply by plugging it into the target system, where it immediately begins executing commands.
    - This makes it an ideal device for quick-access scenarios or when physical presence at the target location is limited.
6. **Payload Versatility**:
    - Users can create a wide range of payloads, from simple keystroke logging or data exfiltration to complex multi-stage attacks.
    - Common payloads include creating backdoors, downloading malware, collecting credentials, or disabling system security settings.

### Common Uses in Penetration Testing and Security Audits

1. **Credential Harvesting**:
    - The Rubber Ducky can be programmed to launch a script that quickly opens a command prompt or powershell, extracts credentials, and sends them back to the attacker or saves them locally.
2. **Backdoor Installation**:
    - A payload can be written to download and install remote access tools, giving the tester long-term access to the machine after the Rubber Ducky has been removed.
3. **Security Testing for HID Injection**:
    - The Rubber Ducky is often used to test a systemâ€™s defenses against USB HID attacks and validate security awareness programs, highlighting the risks associated with plugging in unknown USB devices.
4. **System Manipulation and Information Gathering**:
    - Scripts can be written to gather system information (e.g., IP configuration, user accounts, network connections) and send it back to a remote server, providing intelligence on the target network.
5. **Multi-Platform Attacks**:
    - Because of its compatibility with multiple operating systems, a single Rubber Ducky can be configured to detect the operating system and execute OS-specific commands, adapting on the fly.

### Security Implications and Defenses

While the USB Rubber Ducky is a valuable tool for cybersecurity professionals, it also highlights a serious security risk. Because it appears as a harmless USB device (keyboard), it can bypass many endpoint security measures designed to block USB storage or other devices.

**Defenses include**:

- Implementing strict USB policies (e.g., disabling external USB devices, whitelisting specific devices only).
- Educating employees on the risks of unknown USB devices.
- Utilizing advanced endpoint detection and response (EDR) solutions that recognize unusual keystroke patterns or command sequences.
- Enforcing secure screen locking policies, preventing unattended systems from being vulnerable to physical attacks.

### Limitations

While powerful, the USB Rubber Ducky has some limitations:

- **Physical Access Required**: To execute a payload, physical access to the target machine is necessary.
- **Dependent on Unlocked Workstations**: It can only deliver payloads on machines where the user is logged in and the workstation is unlocked.
- **Detection by Advanced Security Systems**: Some security solutions can detect unusual keystroke patterns and behavior generated by the device, potentially flagging or blocking its activity.

### Variants and Similar Devices

In addition to the classic USB Rubber Ducky, Hak5 and other companies offer similar devices for USB-based attacks:

- **Bash Bunny**: A more advanced Hak5 device with multiple payload types and USB emulation modes, including mass storage and serial devices.
- **BadUSB Devices**: Modified USB devices with BadUSB firmware exploit vulnerabilities in USB protocols to inject malicious commands.

### Conclusion

The USB Rubber Ducky is a staple in physical penetration testing due to its stealth, ease of use, and powerful scripting capabilities. It underscores the importance of physical security and USB device management in protecting against social engineering and insider threats.